<link rel="import" href="../../../bower_components/polymer/polymer-element.html">

<link rel="import" href="./line-chart.html">
<link rel="import" href="./weather-symbol.html">

<dom-module id="weather-day">
  <template>

    <style>
      :host {
        display: block;
        --grid-last-column: 9;
      }

      .weatherGrid_date {
        display: flex;
        align-items: flex-end;		
        justify-content: space-between;	
        
        /* border-top: 1px dashed gray; */
        grid-column: 1 / var(--grid-last-column);
      }

      .symbol_svg {
        width: 32px;
      }

      .weatherGrid_hour {
        font-size: 1rem;
        text-align: center;
        grid-row: 2;       
        /*border: 1px dashed tan;*/
      }
      .weatherGrid_symbol {
        grid-row: 3;  
        text-align: center;
        /*border: 1px dashed bisque;*/
      }
      .weatherGrid_temperature {
        font-size: 1.25rem;
        font-weight: 700;
        text-align: center;
        /*border: 1px dashed cadetblue;*/
      }

      .lineChart{
        grid-column: 1 / var(--grid-last-column);
      }

      .barChart {
        grid-column: 1 / var(--grid-last-column);
      }

      .linechart_svg{
        width: 100%;
      }

    </style>


    <div class="weatherGrid_date">
      <div class="date_day">[[dayName]]</div>
    </div>
  
    <template is="dom-repeat" items="[[weatherData]]" as="entry">
      <template is="dom-if" if="{{_isFourth(index)}}">
        
        <div class="weatherGrid_hour">
          {{entry.hour}}
        </div>
        
        <div class="weatherGrid_symbol">    
          <weather-symbol weather-now-data="[[entry]]"></weather-symbol>
        </div>
          
        <div class="weatherGrid_temperature">
            <template is="dom-if" if="{{_isFourth(index)}}">
              {{_hideNaN(entry.temperature)}}<span class="degree">&#176;</span>   
            </template>
        </div>

      </template>    
    </template>
    <section class="lineChart">
      <line-chart weather-data="[[weatherData]]"></line-chart>          
    </section>

  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class WeatherDay extends Polymer.Element {
      static get is() { return 'weather-day'; }
      
      static get properties() {
        return {
          dayName: {
            type: String
          },
          weatherData: {
            type: Array          
          }
        };
      }

      _everyFourth(index, item) {
        return index % 3 === 0 ? this._hideNaN(item) : '';
      }

      _hideNaN(item){
        const result = Number.isNaN(item) ? '' : item;
        return result; 
      }

      _isFourth(index) {
        return (index + 1) % 3 === 0;
      }
    }

    window.customElements.define(WeatherDay.is, WeatherDay);
  </script>
</dom-module>
