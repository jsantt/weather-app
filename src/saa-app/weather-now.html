<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<link rel="import" href="./weather-symbol.html">
<link rel="import" href="./weather-symbol-name.html">


<dom-module id="weather-now">
    <template>

    <style>
        :host {
            display: block;
        }

        .weatherNow {
		    display: flex;
            align-items: center;
		    justify-content: center;
        }
	
        .temperature {
            font-size: 3.052rem;
        }
        

        .degree {
            font-size: 1.5rem;
            vertical-align: top;
        }

        .symbolText {
            color: #333;
            font-size: 1.25rem;
            text-align: center;
        }

    </style>

    <section class="weatherNow">
        <div class="temperature">
            [[_round(weatherNowData.temperature)]]
            <span class="degree">&#176;C</span>
        </div>
        <div class="symbol">
            <weather-symbol weather-now-data="[[_symbolId(weatherNowData)]]" large="true"></weather-symbol>
        </div>
    </section>
    <div class="symbolText">
        <weather-symbol-name weather-now-data="[[weatherNowData]]"></weather-symbol-name>
    </div>
    <div class="time" style$="[[_calculateMargin()]]">
        [[_timeNow()]]
    </div>

  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class WeatherNow extends Polymer.Element {
      static get is() { return 'weather-now'; }
      
      static get properties() {
        return {
            weatherNowData: {
                type: Object
            }
        };
      }

      _calculateMargin(){
          const hours = new Date().getHours();
          const margin = ((hours - 1) / 24)*100;
          return 'margin-left:' + margin + '%';
      }

      _round(temperature) {
        return Math.round(temperature*10) / 10;
      }

      _symbolId(weatherNowData){
        return weatherNowData.symbol;
      }

      _timeNow() {
        const now = new Date();
        const minutes = now.getMinutes();

        const fullMinutes = minutes < 10 ? '0' + minutes : minutes;

        const time = now.getHours() + '.' + fullMinutes;
        return time;
      }
    }

    window.customElements.define(WeatherNow.is, WeatherNow);
  </script>
</dom-module>
