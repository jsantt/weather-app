<link rel="import" href="../bower_components/polymer/polymer-element.html">

<link rel="import" href="./weather-day.html">

<dom-module id="weather-days">
  <template>

    <style>
      :host {
        display: block;
      }

      .weatherGrid {
        display: grid;
        grid-row-gap: 0;
        grid-template-columns: repeat(25, 1fr);
        grid-template-rows: minmax(1.4rem, auto);
      }
	

    </style>

      <!-- today -->
      <weather-day 
      class="weatherGrid"
      day-number="1"
      min-temperature="[[minTemperature]]"
      show-time-now="true"
      show-wind="[[showWind]]"
      forecast-data="[[todayData]]"></weather-day>
  
      <!-- tomorrow -->
      <weather-day 
      class="weatherGrid"
      day-number="2"
      min-temperature="[[minTemperature]]"
      show-wind="[[showWind]]"
      forecast-data="[[day2Data]]"></weather-day>

      <!-- day after tomorrow -->
      <weather-day 
      class="weatherGrid"
      day-number="3"
      min-temperature="[[minTemperature]]"
      show-wind="[[showWind]]"
      forecast-data="[[day3Data]]"></weather-day>
     
  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class WeatherDays extends Polymer.Element {
      static get is() { return 'weather-days'; }

      static get properties() {
        return {
          forecastData: {
            type: Array
          },
          showWind: {
            type: Boolean,
            reflectToAttribute: true
          },
          todayData: {
            type: Array,
            computed: '_sliceToday(forecastData)'
          },
          day2Data: {
            type: Array,
            computed: '_sliceDay2(forecastData)'
          },
          day3Data: {
            type: Array,
            computed: '_sliceDay3(forecastData)'
          },
          minTemperature: {
            type: Number,
            computed: '_minTemp(forecastData)'
          },
        };
      }

      // for computed properties

      _sliceToday(data) {
        return data.slice(0, 24);
      }

      _sliceDay2(data) {
        return data.slice(24, 48);
      }

      _sliceDay3(data) {
        return data.slice(48, 72);
      }

      _minTemp(data) {
        const min = data.reduce(function (previous, current) {
          
          const currentTemp = Number.isNaN(current.temperature) ? Number.MAX_VALUE : current.temperature;
          return previous.temperature < currentTemp ? previous : current;
        });
        return min.temperature;
      }
    }

    window.customElements.define(WeatherDays.is, WeatherDays);
  </script>
</dom-module>
